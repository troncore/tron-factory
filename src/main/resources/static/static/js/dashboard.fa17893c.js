(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dashboard","chunk-5b769c84","chunk-e34d98be","chunk-2d213a3d"],{"12c8":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dashboard"},[i("div",{staticClass:"page-title"},[t._v(t._s(t.$t("Dashboard")))]),i("div",{staticClass:"chain-info im-card"},[i("div",{staticClass:"card-header"},[t._v("区块链信息")]),i("div",{staticClass:"card-body"},[i("div",{staticClass:"chain-item"},[i("div",{staticClass:"label"},[t._v(t._s(t.$t("名称")))]),i("div",{staticClass:"value"},[t._v(t._s(t.chainInfo.chainName||"-"))])]),i("div",{staticClass:"chain-item"},[i("div",{staticClass:"label"},[t._v(t._s(t.$t("签名算法")))]),i("div",{staticClass:"value"},[t._v(t._s(t.chainInfo.crypto||"-"))])]),i("div",{staticClass:"chain-item"},[i("div",{staticClass:"label"},[t._v(t._s(t.$t("p2pVersion")))]),i("div",{staticClass:"value"},[t._v(t._s(t.chainInfo.p2pVersion||"-"))])]),i("div",{staticClass:"chain-item"},[i("div",{staticClass:"label"},[i("span",{staticClass:"label-inner"},[t._v(t._s(t.$t("状态"))+" "),i("im-tooltip",{staticClass:"im-tooltip",attrs:{content:t.$t("已发布的区块可正常产块")}})],1)]),i("div",{staticClass:"value"},[t._v(t._s(t.$t(["未发布","发布中","已发布"][t.chainStatus]||"-")))])]),i("div",{staticClass:"chain-item"},[i("div",{staticClass:"label"},[0===t.chainStatus?i("el-button",{staticClass:"im-button mini",attrs:{size:"mini",type:"primary"},on:{click:t.handleUpdate}},[i("i",{staticClass:"el-icon-edit"}),t._v(" "+t._s(t.$t("修改"))+" ")]):t._e(),2===t.chainStatus?i("el-button",{staticClass:"im-button mini",attrs:{size:"mini",type:"primary"},on:{click:t.handleExplorer}},[i("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(t.$t("浏览器"))+" ")]):t._e()],1),i("div",{staticClass:"value"},[2===t.chainStatus?i("el-button",{staticClass:"im-button mini",attrs:{size:"mini",disabled:t.deleteLoading},on:{click:t.handleDelete}},[i("i",{class:t.deleteLoading?"el-icon-loading":"el-icon-delete"}),t._v(" "+t._s(t.$t("删除"))+" ")]):t._e()],1)])])]),i("node-list",{on:{nodeList:t.getNodeList,checkChainPublish:function(e){return t.checkChainPublish()}}})],1)},n=[],a=(i("c740"),i("caad"),i("3e60")),o=i("8e6c"),l={name:"dashboard",components:{ImTooltip:o["a"],NodeList:a["default"]},data:function(){return{chainInfo:{chainName:"",crypto:"",p2pVersion:""},chainStatus:-1,nodeList:[],deleteLoading:!1,timeoutID:null}},created:function(){this.getChainInfo(),this.pollChainStatus()},destroyed:function(){clearTimeout(this.timeoutID)},methods:{getChainInfo:function(){var t=this;this.$_api.getStarted.getChainInfo({},(function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e||(t.chainInfo={chainName:i.chainName,crypto:i.crypto,p2pVersion:i.p2pVersion})}))},pollChainStatus:function(){clearTimeout(this.timeoutID),this.timeoutID=setTimeout(this.checkChainPublish,600)},checkChainPublish:function(){var t=this;this.$_api.getStarted.checkChainPublish({},(function(e,i){if(e)return t.chainStatus=-1,void clearTimeout(t.timeoutID);t.chainStatus=i,[0,2].includes(t.chainStatus)?clearTimeout(t.timeoutID):t.pollChainStatus()}))},handleUpdate:function(){this.$router.push("/get-started/chain-edit")},handleDelete:function(){var t=this;~this.nodeList.findIndex((function(t){return 0!==t.deployStatus}))?this.$notify.warning({title:this.$t("base.warning"),message:this.$t("有未停止的节点，无法删除")}):this.$confirm(this.$t("这将会删除此区块链，是否继续？"),this.$t("base.tips"),{cancelButtonText:this.$t("base.cancel"),confirmButtonText:this.$t("base.delete"),center:!0,customClass:"im-message-box",cancelButtonClass:"im-message-cancel-button",confirmButtonClass:"im-message-confirm-button warning"}).then(this.deleteChain).catch((function(){t.$notify.info({title:t.$t("base.cancel"),message:t.$t("base.cancelDelete")})}))},deleteChain:function(){var t=this;this.deleteLoading=!0,this.$_api.getStarted.deleteChain({},(function(e,i){t.deleteLoading=!1,e||(t.$notify.success({title:t.$t("base.successful"),message:t.$t("base.success.delete")}),!0===i&&t.$router.push("/get-started"))}))},getNodeList:function(t){this.nodeList=t},handleExplorer:function(){this.$router.push("/explorer")}}},c=l,r=(i("f87f"),i("2877")),d=Object(r["a"])(c,s,n,!1,null,"9592d912",null);e["default"]=d.exports},"17b0":function(t,e,i){"use strict";var s=i("2e36"),n=i.n(s);n.a},"2e36":function(t,e,i){},"3e60":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"node-list im-card"},[i("div",{staticClass:"card-header"},[t._v("节点信息")]),i("div",{staticClass:"card-body"},[i("div",{staticClass:"table-header"},[i("el-button",{staticClass:"im-button mini",attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleAddNode()}}},[i("i",{staticClass:"el-icon-plus"}),t._v(" "+t._s(t.$t("添加节点")))]),i("el-button",{staticClass:"im-button mini",attrs:{size:"mini",type:"success",loading:t.deployLoading},on:{click:function(e){return t.handleDeploy()}}},[i("i",{staticClass:"el-icon-caret-right"}),t._v(" "+t._s(t.$t("运行节点")))])],1),i("div",{staticClass:"table-box"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticClass:"custom-table",attrs:{data:t.tableData,"empty-text":t.$t("base.emptyData"),border:"","header-align":"center"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",align:"center",width:"60",selectable:t.handleSelectable}}),i("el-table-column",{attrs:{prop:"ip",label:t.$t("IP"),align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-link",{attrs:{type:"primary"},on:{click:function(i){return t.handleDetail(e.row)}}},[t._v(t._s(e.row.ip))])]}}])}),i("el-table-column",{attrs:{prop:"listenPort",label:t.$t("监听端口"),align:"center"}}),i("el-table-column",{attrs:{prop:"isSR",label:t.$t("节点类型"),align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isSR?i("span",{staticClass:"color-success"},[t._v(t._s(t.$t("超级代表")))]):i("span",{staticClass:"color-info"},[t._v(t._s(t.$t("普通节点")))])]}}])}),i("el-table-column",{attrs:{prop:"configStatus",label:t.$t("配置状态"),align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.configStatus?i("el-tag",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(t.$t("已配置")))]):i("el-tag",{attrs:{size:"mini",type:"info"}},[t._v(t._s(t.$t("未配置")))])]}}])}),i("el-table-column",{attrs:{prop:"deployStatus",label:t.$t("运行状态"),align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.deployStatus?i("el-tag",{attrs:{size:"mini",type:"success"}},[t._v(t._s(t.$t("运行中")))]):i("el-tag",{attrs:{size:"mini",type:"info"}},[t._v(t._s(t.$t("停止")))])]}}])}),i("el-table-column",{attrs:{prop:"createTime",width:"180",label:t.$t("创建时间"),align:"center"}}),i("el-table-column",{attrs:{prop:"operate",width:"180",label:t.$t("操作")},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){return t.handleConfig(e.row)}}},[t._v(t._s(t.$t("配置")))]),i("el-button",{attrs:{type:"text"},on:{click:function(i){return t.handleDetail(e.row)}}},[t._v(t._s(t.$t("查看")))]),1===e.row.deployStatus?i("el-button",{attrs:{type:"text",disabled:t.stopIndexs.includes(e.$index)},on:{click:function(i){return t.handleStop(e.row,e.$index)}}},[t._v(t._s(t.$t("停止")))]):t._e(),e.row.ifShowLog?i("el-button",{attrs:{type:"text"},on:{click:function(i){return t.handleLog(e.row)}}},[t._v(t._s(t.$t("日志")))]):t._e()]}}])})],1)],1)]),t.deployDialogVisible?i("node-deploy",{attrs:{visible:t.deployDialogVisible,ids:t.deployNodesIds},on:{"update:visible":function(e){t.deployDialogVisible=e},refreshList:t.getNodeList,checkDeployResult:t.checkDeployResult}}):t._e(),t.logDialogVisible?i("node-log",{attrs:{visible:t.logDialogVisible,"current-row":t.currentRow},on:{"update:visible":function(e){t.logDialogVisible=e}}}):t._e()],1)},n=[],a=(i("c975"),i("a15b"),i("d81d"),i("a434"),i("bad6")),o=i("ae14"),l={name:"node-list",components:{NodeDeploy:o["default"],NodeLog:a["default"]},props:{nodeList:Function},data:function(){return{tableData:[],tableLoading:!1,currentRow:{},deployNodes:[],deployNodesIds:"",stopIndexs:[],logDialogVisible:!1,deployDialogVisible:!1,deployLoading:!1,timeID:null}},created:function(){this.getNodeList()},destroyed:function(){clearInterval(this.timeID)},methods:{getNodeList:function(){var t=this;this.tableLoading=!0,this.$_api.getStarted.getNodeList({},(function(e,i){t.tableLoading=!1,e||(t.tableData=Array.isArray(i)?i:[],t.$emit("nodeList",t.tableData))}))},handleAddNode:function(){this.$router.push("/get-started/node-add")},handleDeploy:function(){var t="";this.tableData.length?this.deployNodesIds.length?this.deployNodes.some((function(t){return 0===t.configStatus}))&&(t=this.$t("请完成所勾选节点的配置")):t=this.$t("请勾选要运行的节点"):t=this.$t("nodesManage.pleaseAddNode"),t?this.$notify.warning({title:this.$t("base.warning"),message:t}):this.deployDialogVisible=!0},checkDeployResult:function(){var t=this,e=!1;this.deployLoading=!0,this.timeID=setInterval((function(){e||(e=!0,t.$_api.getStarted.checkNode({ids:t.deployNodesIds},(function(i,s){if(e=!1,i)return t.deployLoading=!1,void clearInterval(t.timeID);if(s.hasOwnProperty("status")){var n="";switch(s.status){case 0:n="节点已成功启动";break;case 1:n="发布失败，节点未启动成功，请查看日志";break;case 2:n="部分节点未启动成功，请查看日志";break}0===s.status?t.$notify.success({title:t.$t("base.successful"),message:t.$t(n)}):t.$notify.error({title:t.$t("base.warning"),message:t.$t(n)}),t.deployLoading=!1,t.getNodeList(),t.$emit("checkChainPublish"),clearInterval(t.timeID)}})))}),3e3)},handleSelectable:function(t,e){return 1!==t.deployStatus},handleSelectionChange:function(t){this.deployNodes=t,this.deployNodesIds=t.map((function(t){return t.id})).join(",")},handleConfig:function(t){this.$router.push("/node-config/quick?id="+t.id)},handleDetail:function(t){this.$router.push("/get-started/node-view?id="+t.id)},handleStop:function(t,e){var i=this;this.$confirm(this.$t("是否要停止该节点"),this.$t("nodesManage.deleteNodeTipsTitle"),{confirmButtonText:this.$t("base.confirm"),cancelButtonText:this.$t("base.cancel"),center:!0,customClass:"im-message-box",cancelButtonClass:"im-message-cancel-button",confirmButtonClass:"im-message-confirm-button"}).then((function(){return i.stopNode(t,e)})).catch((function(){i.$notify.info({title:i.$t("base.cancel"),message:i.$t("base.cancelDelete")})}))},stopNode:function(t,e){var i=this;this.stopIndexs.push(e),this.$_api.getStarted.stopNode({id:t.id},(function(t){var s=i.stopIndexs.indexOf(e);i.stopIndexs.splice(s,1),t||i.getNodeList()}))},handleLog:function(t){this.logDialogVisible=!0,this.currentRow=t}}},c=l,r=(i("17b0"),i("2877")),d=Object(r["a"])(c,s,n,!1,null,"d4e61886",null);e["default"]=d.exports},"4e26":function(t,e,i){"use strict";var s=i("568a"),n=i.n(s);n.a},"568a":function(t,e,i){},"8e6c":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-tooltip",{attrs:{effect:t.effect,placement:t.placement}},[i("div",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.content)},slot:"content"}),i("i",{staticClass:"icon-question fa fa-question-circle-o",style:t.myStyle})])},n=[],a={name:"im-tooltip",props:{effect:{type:String,default:"dark"},placement:{type:String,default:"top"},content:{},marginLeft:String,marginRight:String},computed:{myStyle:function(){var t={};return"undefined"!==typeof this.marginLeft&&(t.marginLeft=this.marginLeft),"undefined"!==typeof this.marginRight&&(t.marginRight=this.marginRight),t}}},o=a,l=(i("4e26"),i("2877")),c=Object(l["a"])(o,s,n,!1,null,"cc688580",null);e["a"]=c.exports},a15b:function(t,e,i){"use strict";var s=i("23e7"),n=i("44ad"),a=i("fc6a"),o=i("b301"),l=[].join,c=n!=Object,r=o("join",",");s({target:"Array",proto:!0,forced:c||r},{join:function(t){return l.call(a(this),void 0===t?",":t)}})},a434:function(t,e,i){"use strict";var s=i("23e7"),n=i("23cb"),a=i("a691"),o=i("50c4"),l=i("7b0b"),c=i("65f0"),r=i("8418"),d=i("1dde"),u=Math.max,h=Math.min,p=9007199254740991,f="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!d("splice")},{splice:function(t,e){var i,s,d,g,m,b,v=l(this),y=o(v.length),$=n(t,y),_=arguments.length;if(0===_?i=s=0:1===_?(i=0,s=y-$):(i=_-2,s=h(u(a(e),0),y-$)),y+i-s>p)throw TypeError(f);for(d=c(v,s),g=0;g<s;g++)m=$+g,m in v&&r(d,g,v[m]);if(d.length=s,i<s){for(g=$;g<y-s;g++)m=g+s,b=g+i,m in v?v[b]=v[m]:delete v[b];for(g=y;g>y-s+i;g--)delete v[g-1]}else if(i>s)for(g=y-s;g>$;g--)m=g+s-1,b=g+i-1,m in v?v[b]=v[m]:delete v[b];for(g=0;g<i;g++)v[g+$]=arguments[g+2];return v.length=y-s+i,d}})},ae14:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{visible:t.dialogVisible,"custom-class":"im-dialog","close-on-click-modal":!1,"close-on-press-escape":!1,width:"680px",center:""},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("nodesManage.deploy")))])]),i("div",{staticClass:"dialog-content"},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8}},model:{value:t.form.filePath,callback:function(e){t.$set(t.form,"filePath","string"===typeof e?e.trim():e)},expression:"form.filePath"}}),i("div",{staticClass:"el-upload__tip"},[t._v(t._s(t.$t("nodesManage.helpTips.deployFile")))])],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"im-button",on:{click:function(e){t.dialogVisible=!1}}},[t._v(t._s(t.$t("base.cancel")))]),i("el-button",{staticClass:"im-button",attrs:{type:"primary",loading:t.loading},on:{click:t.handleSubmit}},[t._v(t._s(t.$t("base.save")))])],1)])},n=[],a=(i("c975"),{name:"node-deploy",props:{visible:{type:Boolean,required:!0},ids:{type:String,required:!0}},data:function(){return{form:{filePath:""},loading:!1}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},methods:{handleSubmit:function(){this.form.filePath?~this.form.filePath.indexOf("java-tron-1.0.0.zip")?this.startDeploy():this.$notify({title:this.$t("base.warning"),message:this.$t("nodesManage.valid.inputRightPath"),type:"warning"}):this.$notify({title:this.$t("base.warning"),message:this.$t("nodesManage.valid.inputFilePath"),type:"warning"})},startDeploy:function(){var t=this;this.loading=!0,this.$_api.getStarted.deployNode({ids:this.ids,filePath:this.form.filePath},(function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.loading=!1,!e){if(i.hasOwnProperty("status")){var s="";switch(i.status){case 0:s="节点正在启动中，请稍等......";break;case 1:s="初次运行区块链节点时，其中SR节点数量必须>=1且为奇数";break;default:s="节点未启动成功，请查看日志"}0===i.status?t.$notify.success({title:t.$t("base.successful"),message:t.$t(s)}):t.$notify.error({title:t.$t("base.warning"),message:t.$t(s)})}t.$emit("checkDeployResult"),t.$emit("update:visible",!1)}}))}}}),o=a,l=i("2877"),c=Object(l["a"])(o,s,n,!1,null,"3b008005",null);e["default"]=c.exports},bad6:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{visible:t.dialogVisible,"custom-class":"im-dialog","close-on-click-modal":!1,"close-on-press-escape":!1,width:"680px",top:"200px",center:""},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("nodesManage.logDialogTitle")))])]),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.initLoading,expression:"initLoading"}],staticClass:"dialog-content",staticStyle:{"min-height":"200px"}},[i("el-timeline",t._l(t.logInfo,(function(e,s){return i("el-timeline-item",{key:s,attrs:{type:"primary"}},[i("div",{staticClass:"log-content",domProps:{innerHTML:t._s(e)}})])})),1),i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.processingShow,expression:"processingShow"}],staticStyle:{"margin-left":"30px"},attrs:{type:"text",loading:t.processingLoading}},[t._v(t._s(t.processingText))])],1)])},n=[],a=(i("d81d"),i("ac1f"),i("5319"),{name:"node-log",props:{visible:{},currentRow:{}},data:function(){return{logInfo:[],initLoading:!0,processingShow:!1,processingLoading:!1,processingText:this.$t("nodesManage.emptyLog"),timeID:null}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},created:function(){this.init()},destroyed:function(){clearInterval(this.timeID)},methods:{init:function(){this.getLogInfo(),this.timeID=setInterval(this.getLogInfo,5e3)},getLogInfo:function(){var t=this;this.$_api.getStarted.getNodeLog({id:this.currentRow.id},(function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.initLoading=!1,t.processingShow=!0,t.processingLoading=!0,t.processingText=t.$t("nodesManage.loadingLog"),e)return t.processingLoading=!1,t.processingText=t.$t("nodesManage.emptyLog"),void clearInterval(t.timeID);-1!==i.status&&1!==i.status||(t.processingShow=!1,t.processingLoading=!1,clearInterval(t.timeID)),Array.isArray(i.logInfo)?t.logInfo=i.logInfo.map((function(t){return t.replace(/^(\[.*\])(.*)/,'<i class="remark-time">$1</i>$2')})):(t.processingLoading=!1,t.processingText=t.$t("nodesManage.emptyLog"),clearInterval(t.timeID))}))}}}),o=a,l=(i("d09c"),i("2877")),c=Object(l["a"])(o,s,n,!1,null,"00ec055e",null);e["default"]=c.exports},c740:function(t,e,i){"use strict";var s=i("23e7"),n=i("b727").findIndex,a=i("44d2"),o="findIndex",l=!0;o in[]&&Array(1)[o]((function(){l=!1})),s({target:"Array",proto:!0,forced:l},{findIndex:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a(o)},c78a:function(t,e,i){},ca89:function(t,e,i){},d09c:function(t,e,i){"use strict";var s=i("ca89"),n=i.n(s);n.a},f87f:function(t,e,i){"use strict";var s=i("c78a"),n=i.n(s);n.a}}]);
//# sourceMappingURL=dashboard.fa17893c.js.map