(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1783daee","chunk-2d0d0f2b","chunk-2d0c177b"],{"15a3":function(e,t,i){"use strict";var o=i("2be3"),l=i.n(o);l.a},"2be3":function(e,t,i){},"45bf":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{visible:e.dialogVisible,"custom-class":"im-dialog","close-on-click-modal":!1,"close-on-press-escape":!1,width:"680px",top:"200px",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"title"},[e._v(e._s(e.$t("deployNodes.logDialogTitle")))])]),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.initLoading,expression:"initLoading"}],staticClass:"dialog-content"},[i("el-timeline",e._l(e.logInfo,(function(t,o){return i("el-timeline-item",{key:o,attrs:{type:"primary"}},[e._v(" "+e._s(t)+" ")])})),1),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.processingShow,expression:"processingShow"}],staticStyle:{"margin-left":"30px"},attrs:{type:"text",loading:e.processingLoading}},[e._v(e._s(e.processingText))])],1)])},l=[],n=(i("c975"),i("159b"),{name:"LogDialog",props:{visible:{},currentRow:{}},data:function(){return{logInfo:[],initLoading:!0,processingShow:!1,processingLoading:!1,processingText:this.$t("deployNodes.emptyLog"),timeID:null}},computed:{dialogVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},created:function(){this.init()},destroyed:function(){clearInterval(this.timeID)},methods:{init:function(){this.getLogInfo(),this.timeID=setInterval(this.getLogInfo,5e3)},getLogInfo:function(){var e=this;this.$_api.nodeList.getLogInfo({id:this.currentRow.id},(function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.initLoading=!1,e.processingShow=!0,e.processingLoading=!0,e.processingText=e.$t("deployNodes.loadingLog"),t)return e.processingLoading=!1,e.processingText=e.$t("deployNodes.emptyLog"),void clearInterval(e.timeID);e.logInfo=i.logInfo||[],e.logInfo.length?e.logInfo.forEach((function(t){t.indexOf("deploy finish")>-1?(e.processingLoading=!1,e.processingText=e.$t("deployNodes.deployComplete"),clearInterval(e.timeID)):"ssh connect failed"===t&&(e.processingLoading=!1,e.processingText=e.$t("deployNodes.deployFail"),clearInterval(e.timeID))})):(e.processingLoading=!1,e.processingText=e.$t("deployNodes.emptyLog"),clearInterval(e.timeID))}))}}}),s=n,a=i("2877"),r=Object(a["a"])(s,o,l,!1,null,"07820194",null);t["default"]=r.exports},"4e82":function(e,t,i){"use strict";var o=i("23e7"),l=i("1c0b"),n=i("7b0b"),s=i("d039"),a=i("b301"),r=[],d=r.sort,c=s((function(){r.sort(void 0)})),p=s((function(){r.sort(null)})),u=a("sort"),g=c||!p||u;o({target:"Array",proto:!0,forced:g},{sort:function(e){return void 0===e?d.call(n(this)):d.call(n(this),l(e))}})},"63d2":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page-view deploy-nodes"},[i("div",{staticClass:"box-view"},[i("div",{staticClass:"page-header"},[i("el-button",{staticClass:"im-button large",attrs:{loading:e.batchDeployLoading,type:"primary"},on:{click:e.handleOpenDeployDialog}},[e._v(e._s(e.$t("deployNodes.batchDeploy")))])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"custom-table",attrs:{data:e.tableData,"empty-text":e.$t("base.emptyData"),"header-align":"center",border:""},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"id",label:"ID",align:"center"}}),i("el-table-column",{attrs:{prop:"userName",label:e.$t("deployNodes.sshUserName"),align:"center"}}),i("el-table-column",{attrs:{prop:"ip",label:"HOST",align:"center"}}),i("el-table-column",{attrs:{prop:"port",label:"SSH PORT",align:"center"}}),i("el-table-column",{attrs:{label:e.$t("deployNodes.isSR"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isSR?i("el-tag",{attrs:{size:"medium",type:"success"}},[e._v("YES")]):i("el-tag",{attrs:{size:"medium",type:"danger"}},[e._v("NO")])]}}])}),i("el-table-column",{attrs:{prop:"status",label:e.$t("base.operate"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.handleViewDeployLog(t.row)}}},[e._v(e._s(e.$t("deployNodes.viewLog")))])]}}])})],1)],1),e.deployDialogVisible?i("deploy-dialog",{attrs:{visible:e.deployDialogVisible},on:{"update:visible":function(t){e.deployDialogVisible=t},deploy:e.handleDeploy}}):e._e(),e.logDialogVisible?i("log-dialog",{attrs:{visible:e.logDialogVisible,"current-row":e.currentViewRow},on:{"update:visible":function(t){e.logDialogVisible=t}}}):e._e()],1)},l=[],n=(i("d81d"),i("4e82"),i("d3b7"),i("07ac"),i("3ca3"),i("ddb0"),i("96cf"),i("1da1")),s=i("69c5"),a=i("45bf"),r={name:"deploy-nodes",components:{LogDialog:a["default"],DeployDialog:s["default"]},data:function(){return{batchDeployLoading:!1,tableData:[],tableLoading:!1,tableSelections:[],currentViewRow:{},deployDialogVisible:!1,logDialogVisible:!1}},computed:{batchDeployBtnType:function(){return this.tableSelections.length?"success":"info"}},created:function(){this.getNodeList()},methods:{getNodeList:function(){var e=this;this.tableLoading=!0,this.$_api.nodeList.allNodeInfo({},(function(t,i){e.tableLoading=!1,t||(e.tableData=i.sort((function(e,t){return e.id-t.id})))}))},handleSelectionChange:function(e){this.tableSelections=e},handleOpenDeployDialog:function(){this.tableSelections.length?this.deployDialogVisible=!0:this.$message({type:"warning",message:this.$t("deployNodes.mustSelectNodes")})},handleDeploy:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var i,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.deployDialogVisible=!1,this.batchDeployLoading=!0,i=this.tableSelections.map((function(e){return o.deployNode(e,t)})),e.next=5,Promise.all(i);case 5:this.$message({type:"success",message:this.$t("deployNodes.deployingTips")}),this.refreshDeployedNodeList();case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),deployNode:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(o){e.$_api.nodeList.deployNode({id:t.id,isSR:t.isSR,path:i.filePath},(function(e){o(e?{id:t.id,ok:!1}:{id:t.id,ok:!0})}))}))},refreshDeployedNodeList:function(){var e=this,t=this.tableSelections.map((function(e){return e.id})),i=!1,o=setInterval((function(){i||(i=!0,e.$_api.nodeList.checkNode(t,(function(t,l){if(i=!1,t)return e.batchDeployLoading=!1,void clearInterval(o);Object.values(l).every((function(e){return"deploy finish"===e}))&&(e.batchDeployLoading=!1,clearInterval(o))})))}),5e3)},handleViewDeployLog:function(e){this.logDialogVisible=!0,this.currentViewRow=e}}},d=r,c=(i("15a3"),i("2877")),p=Object(c["a"])(d,o,l,!1,null,"3fc6dcc7",null);t["default"]=p.exports},"69c5":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{visible:e.dialogVisible,"custom-class":"im-dialog","close-on-click-modal":!1,"close-on-press-escape":!1,width:"680px",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"title"},[e._v(e._s(e.$t("deployNodes.deployDialogTitle")))])]),i("div",{staticClass:"dialog-content"},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8}},model:{value:e.form.filePath,callback:function(t){e.$set(e.form,"filePath","string"===typeof t?t.trim():t)},expression:"form.filePath"}}),i("div",{staticClass:"el-upload__tip"},[e._v(e._s(e.$t("deployNodes.deployHelpTips")))])],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"im-button",on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("base.cancel")))]),i("el-button",{staticClass:"im-button",attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v(e._s(e.$t("base.save")))])],1)])},l=[],n=(i("c975"),{name:"deploy-dialog",props:{visible:{type:Boolean,required:!0}},data:function(){return{form:{filePath:""},loading:!1}},computed:{dialogVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},methods:{handleSubmit:function(){this.form.filePath?~this.form.filePath.indexOf("java-tron-1.0.0.zip")?this.$emit("deploy",this.form):this.$message({type:"warning",message:this.$t("deployNodes.valid.inputRightPath")}):this.$message({type:"warning",message:this.$t("deployNodes.valid.inputFilePath")})}}}),s=n,a=i("2877"),r=Object(a["a"])(s,o,l,!1,null,"7d5930d4",null);t["default"]=r.exports}}]);
//# sourceMappingURL=chunk-1783daee.94a0dd4f.js.map